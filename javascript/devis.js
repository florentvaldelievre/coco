//initialisation des variables	
	
var co = new Object;
	
var eeisus=0;var eetrue="VRAI";var eefalse="FAUX";var eedec=",";var eeth=" ";var eedecreg=new RegExp(",","g");var eethreg=new RegExp(" ","g"); var fmtdaynamesshort=new Array("dim.","lun.","mar.","mer.","jeu.","ven.","sam."); var fmtdaynameslong=new Array("dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"); var fmtmonthnamesshort=new Array("janv","févr","mars","avr","mai","juin","juil","Août","sept","oct","nov","déc"); var fmtmonthnameslong=new Array("janvier","février","mars","avril","mai","juin","juillet","Août","septembre","octobre","novembre","décembre"); var fmtstrings=new Array("/",":"); var fmtdate1=new Array(7,32,3,32,11); var fmtdate2=new Array(13,33,17);
	
var arr1xCD3CD11=new Array(9);for(var ii=0;ii<9;ii++){arr1xCD3CD11[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xCD3CD11[ii][jj]=0}};var arr1xY4Y8=new Array(5);for(var ii=0;ii<5;ii++){arr1xY4Y8[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xY4Y8[ii][jj]=0}};var arr1xBB4BB6=new Array(3);for(var ii=0;ii<3;ii++){arr1xBB4BB6[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBB4BB6[ii][jj]=0}};var arr1xBF4BF14=new Array(11);for(var ii=0;ii<11;ii++){arr1xBF4BF14[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBF4BF14[ii][jj]=0}};var arr1xBJ4BJ7=new Array(4);for(var ii=0;ii<4;ii++){arr1xBJ4BJ7[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBJ4BJ7[ii][jj]=0}};var arr1xBN4BN19=new Array(16);for(var ii=0;ii<16;ii++){arr1xBN4BN19[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBN4BN19[ii][jj]=0}};var arr1xBR4BR16=new Array(13);for(var ii=0;ii<13;ii++){arr1xBR4BR16[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBR4BR16[ii][jj]=0}};var arr1xBU4BU8=new Array(5);for(var ii=0;ii<5;ii++){arr1xBU4BU8[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBU4BU8[ii][jj]=0}};var arr1xBZ4BZ40=new Array(37);for(var ii=0;ii<37;ii++){arr1xBZ4BZ40[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBZ4BZ40[ii][jj]=0}};var arr1xAG5AG18=new Array(14);for(var ii=0;ii<14;ii++){arr1xAG5AG18[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xAG5AG18[ii][jj]=0}};var arr1xAJ5AJ48=new Array(44);for(var ii=0;ii<44;ii++){arr1xAJ5AJ48[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xAJ5AJ48[ii][jj]=0}};var arr1xAL5AL48=new Array(44);for(var ii=0;ii<44;ii++){arr1xAL5AL48[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xAL5AL48[ii][jj]=0}};var arr1xAN5AN49=new Array(45);for(var ii=0;ii<45;ii++){arr1xAN5AN49[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xAN5AN49[ii][jj]=0}};var arr1xAP5AP18=new Array(14);for(var ii=0;ii<14;ii++){arr1xAP5AP18[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xAP5AP18[ii][jj]=0}};var arr1xAT8AT47=new Array(40);for(var ii=0;ii<40;ii++){arr1xAT8AT47[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xAT8AT47[ii][jj]=0}};var arr1xBB13BB16=new Array(4);for(var ii=0;ii<4;ii++){arr1xBB13BB16[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBB13BB16[ii][jj]=0}};var arr1xBS23BS30=new Array(8);for(var ii=0;ii<8;ii++){arr1xBS23BS30[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBS23BS30[ii][jj]=0}};var arr1xBA26BA27=new Array(2);for(var ii=0;ii<2;ii++){arr1xBA26BA27[ii]=new Array(1);for(var jj=0;jj<1;jj++){arr1xBA26BA27[ii][jj]=0}};var arr1xL46O46=new Array(1);for(var ii=0;ii<1;ii++){arr1xL46O46[ii]=new Array(4);for(var jj=0;jj<4;jj++){arr1xL46O46[ii][jj]=0}};var eecm3=new Array(new Array(arr1xAJ5AJ48,0,0,13,0));var eecm2=new Array(new Array(arr1xAL5AL48,0,0,13,0));var eecm1=new Array(new Array(arr1xAN5AN49,0,0,13,0));var eecm4=new Array(new Array(arr1xAT8AT47,0,0,38,0));var eecm8=new Array(new Array(arr1xBA26BA27,0,0,1,0));var eecm11=new Array(new Array(arr1xBB13BB16,0,0,2,0));var eecm17=new Array(new Array(arr1xBB4BB6,0,0,1,0));var eecm12=new Array(new Array(arr1xBF4BF14,7,0,10,0),new Array(arr1xBF4BF14,0,0,3,0));var eecm16=new Array(new Array(arr1xBJ4BJ7,0,0,2,0));var eecm9=new Array(new Array(arr1xBN4BN19,0,0,15,0));var eecm10=new Array(new Array(arr1xBR4BR16,0,0,11,0));var eecm7=new Array(new Array(arr1xBS23BS30,0,0,6,0));var eecm14=new Array(new Array(arr1xBU4BU8,0,0,3,0));var eecm6=new Array(new Array(arr1xBZ4BZ40,0,0,35,0));var eecm13=new Array(new Array(arr1xCD3CD11,0,0,8,0));var eecm5=new Array(new Array(arr1xL46O46,0,0,0,3));var eecm15=new Array(new Array(arr1xY4Y8,0,0,3,0));function calc(data){var c1D2=data.TypePrestation;var c1D3=data.ZoneChargement;var c1D4=data.VilleChargementPrecise;var c1D5=data.DateDepart;var c1D6=data.HeureDepart;var c1D7=data.DateDepose;var c1D8=data.HeureDepose;var c1D9=data.Kilometrage;var c1D10=data.VilleDestination;var c1D11=data.Etape1;var c1D12=data.Etape2;var c1D13=data.Etape3;var c1D14=data.Etape4;var c1D15=data.NombreConducteur;var c1D16=data.CoupureConducteur;var c1D17=data.RelaisAller;var c1D18=data.RelaisRetour;var c1D19=data.TypeCar;var c1D20=data.Capacite;var c1D21=data.CodeRemise;var c1BX2=(50);var c1AJ3=(-20);var c1AL3=(-15);var c1BX3=(2);var c1CB3=("3cf22a");var c1CC3=(0.99);var c1V4=(1);var c1X4=("transfert long");var c1BA4=("1 conducteur ");var c1BD4=("aucun");var c1BE4=(0);var c1BH4=("scolaire");var c1BI4=(0.95);var c1BL4=("7 places");var c1BM4=(0.8);var c1BP4=(1);var c1BQ4=(0.95);var c1BS4=(2007);var c1BT4=(1);var c1BW4=(15);var c1CB4=("14bder");var c1CC4=(0.98);var c1V5=(2);var c1X5=("dispo moins de 18h");var c1AH5=("Zone 1");var c1AM5=(1);var c1BA5=("2 conducteurs ");var c1BD5=("1 relais court  100 km");var c1BE5=(100);var c1BH5=("standart");var c1BI5=(1);var c1BL5=("19 places");var c1BM5=(0.9);var c1BP5=(2);var c1BQ5=(0.95);var c1BS5=(2008);var c1BT5=(1.04);var c1BW5=(25);var c1CB5=("453efd");var c1CC5=(0.97);var c1V6=(3);var c1X6=("s�jour");var c1AH6=("Zone 2");var c1AM6=(1.5);arr1xBB4BB6[2][0]=(0);var c1BD6=("1 relais long 250 km");var c1BE6=(200);var c1BH6=("grand tourisme");var c1BI6=(1.05);var c1BL6=("21 places");var c1BM6=(0.92);var c1BP6=(3);var c1BQ6=(1);var c1BS6=(2009);var c1BT6=(1.07);var c1BW6=(50);var c1CB6=("hyu752");var c1CC6=(0.96);var c1V7=(4);var c1X7=("transfert court");var c1AH7=("Zone 3");var c1AM7=(2.5);var c1BD7=("1 relais long 500 km et +");var c1BE7=(300);arr1xBJ4BJ7[3][0]=(0);var c1BL7=("27 places");var c1BM7=(0.94);var c1BP7=(4);var c1BQ7=(1);var c1BS7=(2010);var c1BT7=(1.1);var c1BW7=(75);var c1CB7=("7gh3jy");var c1CC7=(0.95);var c1L8=(220);var c1N8=(220);var c1O8=(220);arr1xY4Y8[4][0]=(0);var c1AH8=("Zone 4");var c1AM8=(2);var c1AR8=(1);var c1AS8=(0.4);arr1xBF4BF14[4][0]=(0);var c1BL8=("33 places");var c1BM8=(0.96);var c1BP8=(5);var c1BQ8=(1.07);arr1xBU4BU8[4][0]=(0);var c1BW8=(100);var c1CB8=("wx88aq");var c1CC8=(0.94);var c1L9=(15);var c1N9=(15);var c1O9=(16);var c1AH9=("Zone 5");var c1AM9=(3.5);var c1AR9=(1.5);var c1AS9=(0.42);arr1xBF4BF14[5][0]=(0);var c1BL9=("49 places");var c1BM9=(0.98);var c1BP9=(6);var c1BQ9=(1.07);var c1BW9=(125);var c1CB9=("wr4f8g");var c1CC9=(0.93);var c1L10=(2);var c1N10=(3);var c1O10=(12);var c1AH10=("Zone 6");var c1AM10=(3);var c1AR10=(2);var c1AS10=(0.45);arr1xBF4BF14[6][0]=(0);var c1BL10=("51 places");var c1BM10=(0.99);var c1BP10=(7);var c1BQ10=(1);var c1BW10=(150);var c1CB10=("qazer5");var c1CC10=(0.92);var c1L11=(30);var c1M11=(30);var c1N11=(30);var c1O11=(30);var c1AH11=("Zone 7");var c1AM11=(3.5);var c1AR11=(2.5);var c1AS11=(0.5);var c1BD11=("aucun");var c1BE11=(0);var c1BL11=("53 places");var c1BM11=(1);var c1BP11=(8);var c1BQ11=(1);var c1BW11=(175);var c1CB11=("abi25f");var c1CC11=(0.91);var c1K12=(200);var c1L12=(0.55);var c1N12=(0.55);var c1O12=(0.55);var c1AH12=("Zone 8");var c1AM12=(2);var c1AR12=(3);var c1AS12=(0.55);var c1BD12=("1 relais court  100 km");var c1BE12=(100);var c1BL12=("55places");var c1BM12=(1.05);var c1BP12=(9);var c1BQ12=(1);var c1BW12=(200);var c1L13=(0.65);var c1M13=(1.4);var c1N13=(0.65);var c1O13=(0.65);var c1AH13=("Zone 9");var c1AM13=(3);var c1AR13=(3.5);var c1AS13=(0.6);var c1BA13=("inf�rieure � 9 heures");var c1BD13=("1 relais long 250 km");var c1BE13=(200);var c1BL13=("57 places");var c1BM13=(1.06);var c1BP13=(10);var c1BQ13=(1);var c1BW13=(225);var c1AH14=("Zone 10");var c1AM14=(2.5);var c1AR14=(4);var c1AS14=(0.65);var c1BA14=("entre 9 heures et 11 heures");var c1BD14=("1 relais long 500 km et +");var c1BE14=(300);var c1BL14=("59 places");var c1BM14=(1.07);var c1BP14=(11);var c1BQ14=(0.95);var c1BW14=(250);var c1L15=(1);var c1M15=(1);var c1N15=(1);var c1O15=(1);var c1AH15=("Zone 11");var c1AM15=(4);var c1AR15=(4.5);var c1AS15=(0.7);var c1BA15=("sup�rieure � 11 heures");var c1BL15=("61 places");var c1BM15=(1.09);var c1BP15=(12);var c1BQ15=(0.95);var c1BW15=(275);var c1AH16=("Zone 12");var c1AM16=(4.5);var c1AR16=(5);var c1AS16=(0.75);arr1xBB13BB16[3][0]=(0);var c1BL16=("63 places");var c1BM16=(1.1);arr1xBR4BR16[12][0]=(0);var c1BW16=(300);var c1AH17=("Zone 13");var c1AM17=(4.5);var c1AR17=(5.5);var c1AS17=(0.8);var c1BL17=("65 places");var c1BM17=(1.25);var c1BW17=(350);var c1AH18=("Zone 14");var c1AM18=(4.5);var c1AR18=(6);var c1AS18=(1);var c1BL18=("73 places");var c1BM18=(1.35);var c1BW18=(400);arr1xAJ5AJ48[14][0]=(0);arr1xAL5AL48[14][0]=(0);arr1xAN5AN49[14][0]=(0);var c1AR19=(6.5);var c1AS19=(1);var c1BL19=("78 places");var c1BM19=(1.36);var c1BW19=(450);arr1xAJ5AJ48[15][0]=(0);arr1xAL5AL48[15][0]=(0);arr1xAN5AN49[15][0]=(0);var c1AR20=(7);var c1AS20=(1);var c1BW20=(500);arr1xAJ5AJ48[16][0]=(0);arr1xAL5AL48[16][0]=(0);arr1xAN5AN49[16][0]=(0);var c1AR21=(7.5);var c1AS21=(1);var c1BW21=(550);var c1U22=(1);arr1xAJ5AJ48[17][0]=(0);arr1xAL5AL48[17][0]=(0);arr1xAN5AN49[17][0]=(0);var c1AR22=(8);var c1AS22=(1);var c1BW22=(600);arr1xAJ5AJ48[18][0]=(0);arr1xAL5AL48[18][0]=(0);arr1xAN5AN49[18][0]=(0);var c1AR23=(8.5);var c1AS23=(1);var c1BP23=(1);var c1BR23=(30);var c1BW23=(650);arr1xAJ5AJ48[19][0]=(0);arr1xAL5AL48[19][0]=(0);arr1xAN5AN49[19][0]=(0);var c1AR24=(9);var c1AS24=(1);var c1BP24=(2);var c1BR24=(0);var c1BW24=(700);var c1R25=("");var c1U25=(1);arr1xAJ5AJ48[20][0]=(0);arr1xAL5AL48[20][0]=(0);arr1xAN5AN49[20][0]=(0);var c1AR25=(9.5);var c1AS25=(1);var c1BP25=(3);var c1BR25=(0);var c1BW25=(750);arr1xAJ5AJ48[21][0]=(0);arr1xAL5AL48[21][0]=(0);arr1xAN5AN49[21][0]=(0);var c1AR26=(10);var c1AS26=(1);var c1AW26=(12);var c1AY26=(13.5);var c1AZ26=(1);var c1BP26=(4);var c1BR26=(-10);var c1BW26=(800);var c1R27=("");arr1xAJ5AJ48[22][0]=(0);arr1xAL5AL48[22][0]=(0);arr1xAN5AN49[22][0]=(0);var c1AR27=(10.5);var c1AS27=(1);var c1AZ27=(1);var c1BP27=(5);var c1BR27=(0);var c1BW27=(850);var c1R28=("");arr1xAJ5AJ48[23][0]=(0);arr1xAL5AL48[23][0]=(0);arr1xAN5AN49[23][0]=(0);var c1AR28=(11);var c1AS28=(1);var c1BP28=(6);var c1BR28=(0);var c1BW28=(900);var c1R29=("");arr1xAJ5AJ48[24][0]=(0);arr1xAL5AL48[24][0]=(0);arr1xAN5AN49[24][0]=(0);var c1AR29=(11.5);var c1AS29=(1);var c1BB29=(13);var c1BP29=(7);var c1BR29=(15);var c1BW29=(950);arr1xAJ5AJ48[25][0]=(0);arr1xAL5AL48[25][0]=(0);arr1xAN5AN49[25][0]=(0);var c1AR30=(12);var c1AS30=(1);arr1xBS23BS30[7][0]=(0);var c1BW30=(1000);arr1xAJ5AJ48[26][0]=(0);arr1xAL5AL48[26][0]=(0);arr1xAN5AN49[26][0]=(0);var c1AR31=(12.5);var c1AS31=(1);var c1BW31=(1050);var c1O32=(0);var c1R32=("");arr1xAJ5AJ48[27][0]=(0);arr1xAL5AL48[27][0]=(0);arr1xAN5AN49[27][0]=(0);var c1AR32=(13);var c1AS32=(1.1);var c1BW32=(1100);var c1R33=("");arr1xAJ5AJ48[28][0]=(0);arr1xAL5AL48[28][0]=(0);arr1xAN5AN49[28][0]=(0);var c1AR33=(13.5);var c1AS33=(1.2);var c1BW33=(1150);var c1O34=(0);var c1R34=("");arr1xAJ5AJ48[29][0]=(0);arr1xAL5AL48[29][0]=(0);arr1xAN5AN49[29][0]=(0);var c1AR34=(14);var c1AS34=(1.3);var c1BW34=(1200);var c1R35=("");arr1xAJ5AJ48[30][0]=(0);arr1xAL5AL48[30][0]=(0);arr1xAN5AN49[30][0]=(0);var c1AR35=(14.5);var c1AS35=(1.4);var c1BW35=(1250);var c1O36=(0);var c1R36=("");arr1xAJ5AJ48[31][0]=(0);arr1xAL5AL48[31][0]=(0);arr1xAN5AN49[31][0]=(0);var c1AR36=(15);var c1AS36=(1.5);var c1BB36=(30);var c1BW36=(1300);var c1U37=(1);arr1xAJ5AJ48[32][0]=(0);arr1xAL5AL48[32][0]=(0);arr1xAN5AN49[32][0]=(0);var c1AR37=(15.5);var c1AS37=(1.6);var c1BW37=(1350);arr1xAJ5AJ48[33][0]=(0);arr1xAL5AL48[33][0]=(0);arr1xAN5AN49[33][0]=(0);var c1AR38=(16);var c1AS38=(1.7);var c1BW38=(1400);arr1xAJ5AJ48[34][0]=(0);arr1xAL5AL48[34][0]=(0);arr1xAN5AN49[34][0]=(0);var c1AR39=(16.5);var c1AS39=(1.8);var c1BW39=(1450);arr1xAJ5AJ48[35][0]=(0);arr1xAL5AL48[35][0]=(0);arr1xAN5AN49[35][0]=(0);var c1AR40=(17);var c1AS40=(1.9);arr1xBZ4BZ40[36][0]=(0);arr1xAJ5AJ48[36][0]=(0);arr1xAL5AL48[36][0]=(0);arr1xAN5AN49[36][0]=(0);var c1AR41=(17.5);var c1AS41=(2);arr1xAJ5AJ48[37][0]=(0);arr1xAL5AL48[37][0]=(0);arr1xAN5AN49[37][0]=(0);var c1AR42=(18);var c1AS42=(2);arr1xAJ5AJ48[38][0]=(0);arr1xAL5AL48[38][0]=(0);arr1xAN5AN49[38][0]=(0);var c1AR43=(18.5);var c1AS43=(2);arr1xAJ5AJ48[39][0]=(0);arr1xAL5AL48[39][0]=(0);arr1xAN5AN49[39][0]=(0);var c1AR44=(19);var c1AS44=(2);arr1xAJ5AJ48[40][0]=(0);arr1xAL5AL48[40][0]=(0);arr1xAN5AN49[40][0]=(0);var c1AR45=(19.5);var c1AS45=(2);arr1xAJ5AJ48[41][0]=(0);arr1xAL5AL48[41][0]=(0);arr1xAN5AN49[41][0]=(0);var c1AR46=(20);var c1AS46=(2);arr1xAJ5AJ48[42][0]=(0);arr1xAL5AL48[42][0]=(0);arr1xAN5AN49[42][0]=(0);arr1xAT8AT47[39][0]=(0);arr1xAJ5AJ48[43][0]=(0);arr1xAL5AL48[43][0]=(0);arr1xAN5AN49[43][0]=(0);arr1xAN5AN49[44][0]=(0);var c1CB2=(c1D21);var c1X3=(c1D2);var c1AM3=(c1D3);var c1BA3=(c1D15);var c1BD3=(c1D17);var c1BH3=(c1D19);var c1BL3=(c1D20);var c1BP3=(eemonth((c1D5)));var c1BS3=(year((c1D5)));arr1xCD3CD11[0][0]=(((str_eq((c1CB2),(c1CB3)))?(c1CC3):(0)));arr1xY4Y8[0][0]=(((str_eq((c1X4),(c1X3)))?(c1V4):(0)));var c1AI4=(((c1D6)*(24)));var c1AK4=(((c1D8)*(24)));arr1xBB4BB6[0][0]=(((str_eq((c1BA4),(c1BA3)))?(1):(0)));arr1xBF4BF14[0][0]=(((str_eq((c1BD4),(c1BD3)))?(c1BE4):(0)));arr1xBJ4BJ7[0][0]=(((str_eq((c1BH4),(c1BH3)))?(c1BI4):(0)));arr1xBN4BN19[0][0]=(((str_eq((c1BL4),(c1BL3)))?(c1BM4):(0)));arr1xBR4BR16[0][0]=(((((c1BP4)==(c1BP3)))?(c1BQ4):(0)));arr1xBU4BU8[0][0]=(((((c1BS4)==(c1BS3)))?(c1BT4):(0)));var c1BX4=(((((((c1BX3)*(v2n(c1BW4))))/(80)))+(c1BX2)));var c1BY4=(((v2n(c1BW4))/(c1BX4)));arr1xBZ4BZ40[0][0]=(((var_eq((c1BW4),(c1D9)))?(c1BY4):(0)));arr1xCD3CD11[1][0]=(((str_eq((c1CB2),(c1CB4)))?(c1CC4):(0)));arr1xY4Y8[1][0]=(((str_eq((c1X5),(c1X3)))?(c1V5):(0)));var c1AI5=(((8)+(((c1AM5)/(2)))));arr1xAJ5AJ48[0][0]=(((str_eq((c1AH5),(c1AM3)))?(((((c1AI5)<=(c1AI4)))?(1):(0))):(0)));var c1AK5=(((16)-(((c1AM5)/(2)))));arr1xAL5AL48[0][0]=(((str_eq((c1AH5),(c1AM3)))?(((((c1AK5)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[0][0]=(((str_eq((c1AH5),(c1AM3)))?(c1AM5):(0)));arr1xBB4BB6[1][0]=(((str_eq((c1BA5),(c1BA3)))?(2):(0)));arr1xBF4BF14[1][0]=(((str_eq((c1BD5),(c1BD3)))?(c1BE5):(0)));arr1xBJ4BJ7[1][0]=(((str_eq((c1BH5),(c1BH3)))?(c1BI5):(0)));arr1xBN4BN19[1][0]=(((str_eq((c1BL5),(c1BL3)))?(c1BM5):(0)));arr1xBR4BR16[1][0]=(((((c1BP5)==(c1BP3)))?(c1BQ5):(0)));arr1xBU4BU8[1][0]=(((((c1BS5)==(c1BS3)))?(c1BT5):(0)));var c1BX5=(((((((c1BX3)*(v2n(c1BW5))))/(80)))+(c1BX2)));var c1BY5=(((v2n(c1BW5))/(c1BX5)));arr1xBZ4BZ40[1][0]=(((var_eq((c1BW5),(c1D9)))?(c1BY5):(0)));arr1xCD3CD11[2][0]=(((str_eq((c1CB2),(c1CB5)))?(c1CC5):(0)));arr1xY4Y8[2][0]=(((str_eq((c1X6),(c1X3)))?(c1V6):(0)));var c1AI6=(((8)+(((c1AM6)/(2)))));arr1xAJ5AJ48[1][0]=(((str_eq((c1AH6),(c1AM3)))?(((((c1AI6)<=(c1AI4)))?(1):(0))):(0)));var c1AK6=(((16)-(((c1AM6)/(2)))));arr1xAL5AL48[1][0]=(((str_eq((c1AH6),(c1AM3)))?(((((c1AK6)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[1][0]=(((str_eq((c1AH6),(c1AM3)))?(c1AM6):(0)));arr1xBF4BF14[2][0]=(((str_eq((c1BD6),(c1BD3)))?(c1BE6):(0)));arr1xBJ4BJ7[2][0]=(((str_eq((c1BH6),(c1BH3)))?(c1BI6):(0)));arr1xBN4BN19[2][0]=(((str_eq((c1BL6),(c1BL3)))?(c1BM6):(0)));arr1xBR4BR16[2][0]=(((((c1BP6)==(c1BP3)))?(c1BQ6):(0)));arr1xBU4BU8[2][0]=(((((c1BS6)==(c1BS3)))?(c1BT6):(0)));var c1BX6=(((((((c1BX3)*(v2n(c1BW6))))/(80)))+(c1BX2)));var c1BY6=(((v2n(c1BW6))/(c1BX6)));arr1xBZ4BZ40[2][0]=(((var_eq((c1BW6),(c1D9)))?(c1BY6):(0)));arr1xCD3CD11[3][0]=(((str_eq((c1CB2),(c1CB6)))?(c1CC6):(0)));arr1xY4Y8[3][0]=(((str_eq((c1X7),(c1X3)))?(c1V7):(0)));var c1AI7=(((8)+(((c1AM7)/(2)))));arr1xAJ5AJ48[2][0]=(((str_eq((c1AH7),(c1AM3)))?(((((c1AI7)<=(c1AI4)))?(1):(0))):(0)));var c1AK7=(((16)-(((c1AM7)/(2)))));arr1xAL5AL48[2][0]=(((str_eq((c1AH7),(c1AM3)))?(((((c1AK7)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[2][0]=(((str_eq((c1AH7),(c1AM3)))?(c1AM7):(0)));var c1BB7=(sumgeneral(2,0,0,eecm17));arr1xBF4BF14[3][0]=(((str_eq((c1BD7),(c1BD3)))?(c1BE7):(0)));arr1xBN4BN19[3][0]=(((str_eq((c1BL7),(c1BL3)))?(c1BM7):(0)));arr1xBR4BR16[3][0]=(((((c1BP7)==(c1BP3)))?(c1BQ7):(0)));arr1xBU4BU8[3][0]=(((((c1BS7)==(c1BS3)))?(c1BT7):(0)));var c1BX7=(((((((c1BX3)*(v2n(c1BW7))))/(80)))+(c1BX2)));var c1BY7=(((v2n(c1BW7))/(c1BX7)));arr1xBZ4BZ40[3][0]=(((var_eq((c1BW7),(c1D9)))?(c1BY7):(0)));arr1xCD3CD11[4][0]=(((str_eq((c1CB2),(c1CB7)))?(c1CC7):(0)));var c1AI8=(((8)+(((c1AM8)/(2)))));arr1xAJ5AJ48[3][0]=(((str_eq((c1AH8),(c1AM3)))?(((((c1AI8)<=(c1AI4)))?(1):(0))):(0)));var c1AK8=(((16)-(((c1AM8)/(2)))));arr1xAL5AL48[3][0]=(((str_eq((c1AH8),(c1AM3)))?(((((c1AK8)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[3][0]=(((str_eq((c1AH8),(c1AM3)))?(c1AM8):(0)));var c1BJ8=(sumgeneral(3,0,0,eecm16));arr1xBN4BN19[4][0]=(((str_eq((c1BL8),(c1BL3)))?(c1BM8):(0)));arr1xBR4BR16[4][0]=(((((c1BP8)==(c1BP3)))?(c1BQ8):(0)));var c1BX8=(((((((c1BX3)*(v2n(c1BW8))))/(80)))+(c1BX2)));var c1BY8=(((v2n(c1BW8))/(c1BX8)));arr1xBZ4BZ40[4][0]=(((var_eq((c1BW8),(c1D9)))?(c1BY8):(0)));arr1xCD3CD11[5][0]=(((str_eq((c1CB2),(c1CB8)))?(c1CC8):(0)));var c1Y9=(sumgeneral(4,0,0,eecm15));var c1AI9=(((8)+(((c1AM9)/(2)))));arr1xAJ5AJ48[4][0]=(((str_eq((c1AH9),(c1AM3)))?(((((c1AI9)<=(c1AI4)))?(1):(0))):(0)));var c1AK9=(((16)-(((c1AM9)/(2)))));arr1xAL5AL48[4][0]=(((str_eq((c1AH9),(c1AM3)))?(((((c1AK9)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[4][0]=(((str_eq((c1AH9),(c1AM3)))?(c1AM9):(0)));arr1xBN4BN19[5][0]=(((str_eq((c1BL9),(c1BL3)))?(c1BM9):(0)));arr1xBR4BR16[5][0]=(((((c1BP9)==(c1BP3)))?(c1BQ9):(0)));var c1BU9=(sumgeneral(4,0,0,eecm14));var c1BX9=(((((((c1BX3)*(v2n(c1BW9))))/(80)))+(c1BX2)));var c1BY9=(((v2n(c1BW9))/(c1BX9)));arr1xBZ4BZ40[5][0]=(((var_eq((c1BW9),(c1D9)))?(c1BY9):(0)));arr1xCD3CD11[6][0]=(((str_eq((c1CB2),(c1CB9)))?(c1CC9):(0)));var c1AI10=(((8)+(((c1AM10)/(2)))));arr1xAJ5AJ48[5][0]=(((str_eq((c1AH10),(c1AM3)))?(((((c1AI10)<=(c1AI4)))?(1):(0))):(0)));var c1AK10=(((16)-(((c1AM10)/(2)))));arr1xAL5AL48[5][0]=(((str_eq((c1AH10),(c1AM3)))?(((((c1AK10)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[5][0]=(((str_eq((c1AH10),(c1AM3)))?(c1AM10):(0)));var c1BD10=(c1D18);arr1xBN4BN19[6][0]=(((str_eq((c1BL10),(c1BL3)))?(c1BM10):(0)));arr1xBR4BR16[6][0]=(((((c1BP10)==(c1BP3)))?(c1BQ10):(0)));var c1BX10=(((((((c1BX3)*(v2n(c1BW10))))/(80)))+(c1BX2)));var c1BY10=(((v2n(c1BW10))/(c1BX10)));arr1xBZ4BZ40[6][0]=(((var_eq((c1BW10),(c1D9)))?(c1BY10):(0)));arr1xCD3CD11[7][0]=(((str_eq((c1CB2),(c1CB10)))?(c1CC10):(0)));var c1AI11=(((8)+(((c1AM11)/(2)))));arr1xAJ5AJ48[6][0]=(((str_eq((c1AH11),(c1AM3)))?(((((c1AI11)<=(c1AI4)))?(1):(0))):(0)));var c1AK11=(((16)-(((c1AM11)/(2)))));arr1xAL5AL48[6][0]=(((str_eq((c1AH11),(c1AM3)))?(((((c1AK11)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[6][0]=(((str_eq((c1AH11),(c1AM3)))?(c1AM11):(0)));arr1xBF4BF14[7][0]=(((str_eq((c1BD11),(c1BD10)))?(c1BE11):(0)));arr1xBN4BN19[7][0]=(((str_eq((c1BL11),(c1BL3)))?(c1BM11):(0)));arr1xBR4BR16[7][0]=(((((c1BP11)==(c1BP3)))?(c1BQ11):(0)));var c1BX11=(((((((c1BX3)*(v2n(c1BW11))))/(80)))+(c1BX2)));var c1BY11=(((v2n(c1BW11))/(c1BX11)));arr1xBZ4BZ40[7][0]=(((var_eq((c1BW11),(c1D9)))?(c1BY11):(0)));arr1xCD3CD11[8][0]=(((str_eq((c1CB2),(c1CB11)))?(c1CC11):(0)));var c1X12=(((str_eq((c1D4),("")))?(""):(c1D4)));var c1AI12=(((8)+(((c1AM12)/(2)))));arr1xAJ5AJ48[7][0]=(((str_eq((c1AH12),(c1AM3)))?(((((c1AI12)<=(c1AI4)))?(1):(0))):(0)));var c1AK12=(((16)-(((c1AM12)/(2)))));arr1xAL5AL48[7][0]=(((str_eq((c1AH12),(c1AM3)))?(((((c1AK12)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[7][0]=(((str_eq((c1AH12),(c1AM3)))?(c1AM12):(0)));var c1BA12=(c1D16);arr1xBF4BF14[8][0]=(((str_eq((c1BD12),(c1BD10)))?(c1BE12):(0)));arr1xBN4BN19[8][0]=(((str_eq((c1BL12),(c1BL3)))?(c1BM12):(0)));arr1xBR4BR16[8][0]=(((((c1BP12)==(c1BP3)))?(c1BQ12):(0)));var c1BX12=(((((((c1BX3)*(v2n(c1BW12))))/(80)))+(c1BX2)));var c1BY12=(((v2n(c1BW12))/(c1BX12)));arr1xBZ4BZ40[8][0]=(((var_eq((c1BW12),(c1D9)))?(c1BY12):(0)));var c1X13=(((str_eq((c1D10),("")))?(""):(c1D10)));var c1AI13=(((8)+(((c1AM13)/(2)))));arr1xAJ5AJ48[8][0]=(((str_eq((c1AH13),(c1AM3)))?(((((c1AI13)<=(c1AI4)))?(1):(0))):(0)));var c1AK13=(((16)-(((c1AM13)/(2)))));arr1xAL5AL48[8][0]=(((str_eq((c1AH13),(c1AM3)))?(((((c1AK13)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[8][0]=(((str_eq((c1AH13),(c1AM3)))?(c1AM13):(0)));arr1xBB13BB16[0][0]=(((str_eq((c1BA13),(c1BA12)))?(1):(0)));arr1xBF4BF14[9][0]=(((str_eq((c1BD13),(c1BD10)))?(c1BE13):(0)));arr1xBN4BN19[9][0]=(((str_eq((c1BL13),(c1BL3)))?(c1BM13):(0)));arr1xBR4BR16[9][0]=(((((c1BP13)==(c1BP3)))?(c1BQ13):(0)));var c1BX13=(((((((c1BX3)*(v2n(c1BW13))))/(80)))+(c1BX2)));var c1BY13=(((v2n(c1BW13))/(c1BX13)));arr1xBZ4BZ40[9][0]=(((var_eq((c1BW13),(c1D9)))?(c1BY13):(0)));var c1X14=(((str_eq((c1D11),("")))?(""):(c1D11)));var c1AI14=(((8)+(((c1AM14)/(2)))));arr1xAJ5AJ48[9][0]=(((str_eq((c1AH14),(c1AM3)))?(((((c1AI14)<=(c1AI4)))?(1):(0))):(0)));var c1AK14=(((16)-(((c1AM14)/(2)))));arr1xAL5AL48[9][0]=(((str_eq((c1AH14),(c1AM3)))?(((((c1AK14)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[9][0]=(((str_eq((c1AH14),(c1AM3)))?(c1AM14):(0)));arr1xBB13BB16[1][0]=(((str_eq((c1BA14),(c1BA12)))?(2):(0)));arr1xBF4BF14[10][0]=(((str_eq((c1BD14),(c1BD10)))?(c1BE14):(0)));arr1xBN4BN19[10][0]=(((str_eq((c1BL14),(c1BL3)))?(c1BM14):(0)));arr1xBR4BR16[10][0]=(((((c1BP14)==(c1BP3)))?(c1BQ14):(0)));var c1BX14=(((((((c1BX3)*(v2n(c1BW14))))/(80)))+(c1BX2)));var c1BY14=(((v2n(c1BW14))/(c1BX14)));arr1xBZ4BZ40[10][0]=(((var_eq((c1BW14),(c1D9)))?(c1BY14):(0)));var c1X15=(((str_eq((c1D12),("")))?(""):(c1D12)));var c1AI15=(((8)+(((c1AM15)/(2)))));arr1xAJ5AJ48[10][0]=(((str_eq((c1AH15),(c1AM3)))?(((((c1AI15)<=(c1AI4)))?(1):(0))):(0)));var c1AK15=(((16)-(((c1AM15)/(2)))));arr1xAL5AL48[10][0]=(((str_eq((c1AH15),(c1AM3)))?(((((c1AK15)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[10][0]=(((str_eq((c1AH15),(c1AM3)))?(c1AM15):(0)));arr1xBB13BB16[2][0]=(((str_eq((c1BA15),(c1BA12)))?(3):(0)));arr1xBN4BN19[11][0]=(((str_eq((c1BL15),(c1BL3)))?(c1BM15):(0)));arr1xBR4BR16[11][0]=(((((c1BP15)==(c1BP3)))?(c1BQ15):(0)));var c1BX15=(((((((c1BX3)*(v2n(c1BW15))))/(80)))+(c1BX2)));var c1BY15=(((v2n(c1BW15))/(c1BX15)));arr1xBZ4BZ40[11][0]=(((var_eq((c1BW15),(c1D9)))?(c1BY15):(0)));var c1R16=(((str_ne((c1D2),("s�jour")))?(((var_gr((c1D9),(1450)))?(" - Distance trop importante !"):(""))):("")));var c1X16=(((str_eq((c1D13),("")))?(""):(c1D13)));var c1AI16=(((8)+(((c1AM16)/(2)))));arr1xAJ5AJ48[11][0]=(((str_eq((c1AH16),(c1AM3)))?(((((c1AI16)<=(c1AI4)))?(1):(0))):(0)));var c1AK16=(((16)-(((c1AM16)/(2)))));arr1xAL5AL48[11][0]=(((str_eq((c1AH16),(c1AM3)))?(((((c1AK16)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[11][0]=(((str_eq((c1AH16),(c1AM3)))?(c1AM16):(0)));var c1BF16=(sumgeneral(8,0,0,eecm12));arr1xBN4BN19[12][0]=(((str_eq((c1BL16),(c1BL3)))?(c1BM16):(0)));var c1BX16=(((((((c1BX3)*(v2n(c1BW16))))/(80)))+(c1BX2)));var c1BY16=(((v2n(c1BW16))/(c1BX16)));arr1xBZ4BZ40[12][0]=(((var_eq((c1BW16),(c1D9)))?(c1BY16):(0)));var c1R17=(((var_gr((c1D9),(250)))?(((str_eq((c1D19),("scolaire")))?(" - trop km, Changer type car !"):(""))):("")));var c1X17=(((str_eq((c1D14),("")))?(""):(c1D14)));var c1AI17=(((8)+(((c1AM17)/(2)))));arr1xAJ5AJ48[12][0]=(((str_eq((c1AH17),(c1AM3)))?(((((c1AI17)<=(c1AI4)))?(1):(0))):(0)));var c1AK17=(((16)-(((c1AM17)/(2)))));arr1xAL5AL48[12][0]=(((str_eq((c1AH17),(c1AM3)))?(((((c1AK17)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[12][0]=(((str_eq((c1AH17),(c1AM3)))?(c1AM17):(0)));var c1BB17=(sumgeneral(3,0,0,eecm11));arr1xBN4BN19[13][0]=(((str_eq((c1BL17),(c1BL3)))?(c1BM17):(0)));var c1BR17=(sumgeneral(12,0,0,eecm10));var c1BX17=(((((((c1BX3)*(v2n(c1BW17))))/(80)))+(c1BX2)));var c1BY17=(((v2n(c1BW17))/(c1BX17)));arr1xBZ4BZ40[13][0]=(((var_eq((c1BW17),(c1D9)))?(c1BY17):(0)));var c1N18=(((((((c1D7)+(c1D8)))-(((c1D5)+(c1D6)))))*(24)));var c1AI18=(((8)+(((c1AM18)/(2)))));arr1xAJ5AJ48[13][0]=(((str_eq((c1AH18),(c1AM3)))?(((((c1AI18)<=(c1AI4)))?(1):(0))):(0)));var c1AK18=(((16)-(((c1AM18)/(2)))));arr1xAL5AL48[13][0]=(((str_eq((c1AH18),(c1AM3)))?(((((c1AK18)>=(c1AK4)))?(1):(0))):(0)));arr1xAN5AN49[13][0]=(((str_eq((c1AH18),(c1AM3)))?(c1AM18):(0)));arr1xBN4BN19[14][0]=(((str_eq((c1BL18),(c1BL3)))?(c1BM18):(0)));var c1BX18=(((((((c1BX3)*(v2n(c1BW18))))/(80)))+(c1BX2)));var c1BY18=(((v2n(c1BW18))/(c1BX18)));arr1xBZ4BZ40[14][0]=(((var_eq((c1BW18),(c1D9)))?(c1BY18):(0)));arr1xBN4BN19[15][0]=(((str_eq((c1BL19),(c1BL3)))?(c1BM19):(0)));var c1BX19=(((((((c1BX3)*(v2n(c1BW19))))/(80)))+(c1BX2)));var c1BY19=(((v2n(c1BW19))/(c1BX19)));arr1xBZ4BZ40[15][0]=(((var_eq((c1BW19),(c1D9)))?(c1BY19):(0)));var c1BX20=(((((((c1BX3)*(v2n(c1BW20))))/(80)))+(c1BX2)));var c1BY20=(((v2n(c1BW20))/(c1BX20)));arr1xBZ4BZ40[16][0]=(((var_eq((c1BW20),(c1D9)))?(c1BY20):(0)));var c1O21=(((((c1D7)-(c1D5)))+(1)));var c1BX21=(((((((c1BX3)*(v2n(c1BW21))))/(80)))+(c1BX2)));var c1BY21=(((v2n(c1BW21))/(c1BX21)));arr1xBZ4BZ40[17][0]=(((var_eq((c1BW21),(c1D9)))?(c1BY21):(0)));var c1L22=(v2n(c1D9));var c1O22=(v2n(c1D9));var c1BP22=(weekday((c1D5),(1)));var c1BX22=(((((((c1BX3)*(v2n(c1BW22))))/(80)))+(c1BX2)));var c1BY22=(((v2n(c1BW22))/(c1BX22)));arr1xBZ4BZ40[18][0]=(((var_eq((c1BW22),(c1D9)))?(c1BY22):(0)));arr1xBS23BS30[0][0]=(((((c1BP22)==(c1BP23)))?(c1BR23):(0)));var c1BX23=(((((((c1BX3)*(v2n(c1BW23))))/(80)))+(c1BX2)));var c1BY23=(((v2n(c1BW23))/(c1BX23)));arr1xBZ4BZ40[19][0]=(((var_eq((c1BW23),(c1D9)))?(c1BY23):(0)));arr1xBS23BS30[1][0]=(((((c1BP22)==(c1BP24)))?(c1BR24):(0)));var c1BX24=(((((((c1BX3)*(v2n(c1BW24))))/(80)))+(c1BX2)));var c1BY24=(((v2n(c1BW24))/(c1BX24)));arr1xBZ4BZ40[20][0]=(((var_eq((c1BW24),(c1D9)))?(c1BY24):(0)));var c1O25=(((c1O8)*(c1O21)));arr1xBS23BS30[2][0]=(((((c1BP22)==(c1BP25)))?(c1BR25):(0)));var c1BX25=(((((((c1BX3)*(v2n(c1BW25))))/(80)))+(c1BX2)));var c1BY25=(((v2n(c1BW25))/(c1BX25)));arr1xBZ4BZ40[21][0]=(((var_eq((c1BW25),(c1D9)))?(c1BY25):(0)));var c1R26=(((((((v2n(c1D9))/(c1N18)))>(72)))?(" - Dur�e trop courte pour la distance"):("")));arr1xBS23BS30[3][0]=(((((c1BP22)==(c1BP26)))?(c1BR26):(0)));var c1BX26=(((((((c1BX3)*(v2n(c1BW26))))/(80)))+(c1BX2)));var c1BY26=(((v2n(c1BW26))/(c1BX26)));arr1xBZ4BZ40[22][0]=(((var_eq((c1BW26),(c1D9)))?(c1BY26):(0)));var c1U27=(v2n(((str_ne((c1R27),("")))?("0"):(1))));arr1xBS23BS30[4][0]=(((((c1BP22)==(c1BP27)))?(c1BR27):(0)));var c1BX27=(((((((c1BX3)*(v2n(c1BW27))))/(80)))+(c1BX2)));var c1BY27=(((v2n(c1BW27))/(c1BX27)));arr1xBZ4BZ40[23][0]=(((var_eq((c1BW27),(c1D9)))?(c1BY27):(0)));var c1U28=(v2n(((str_ne((c1R28),("")))?("0"):(1))));arr1xBS23BS30[5][0]=(((((c1BP22)==(c1BP28)))?(c1BR28):(0)));var c1BX28=(((((((c1BX3)*(v2n(c1BW28))))/(80)))+(c1BX2)));var c1BY28=(((v2n(c1BW28))/(c1BX28)));arr1xBZ4BZ40[24][0]=(((var_eq((c1BW28),(c1D9)))?(c1BY28):(0)));var c1U29=(v2n(((str_ne((c1R29),("")))?("0"):(1))));arr1xBS23BS30[6][0]=(((((c1BP22)==(c1BP29)))?(c1BR29):(0)));var c1BX29=(((((((c1BX3)*(v2n(c1BW29))))/(80)))+(c1BX2)));var c1BY29=(((v2n(c1BW29))/(c1BX29)));arr1xBZ4BZ40[25][0]=(((var_eq((c1BW29),(c1D9)))?(c1BY29):(0)));var c1L30=(((((var_le((c1D9),(c1K12)))?(((v2n(c1D9))*(c1L12))):(((v2n(c1D9))*(c1L13)))))*(1.8)));var c1M30=(((((v2n(c1D9))*(1.75)))*(c1M13)));var c1N30=(((var_le((c1D9),(c1K12)))?(((v2n(c1D9))*(c1N12))):(((v2n(c1D9))*(c1N13)))));var c1O30=(((var_le((c1D9),(c1K12)))?(((v2n(c1D9))*(c1O12))):(((v2n(c1D9))*(c1O13)))));var c1BX30=(((((((c1BX3)*(v2n(c1BW30))))/(80)))+(c1BX2)));var c1BY30=(((v2n(c1BW30))/(c1BX30)));arr1xBZ4BZ40[26][0]=(((var_eq((c1BW30),(c1D9)))?(c1BY30):(0)));var c1BS31=(sumgeneral(7,0,0,eecm7));var c1BX31=(((((((c1BX3)*(v2n(c1BW31))))/(80)))+(c1BX2)));var c1BY31=(((v2n(c1BW31))/(c1BX31)));arr1xBZ4BZ40[27][0]=(((var_eq((c1BW31),(c1D9)))?(c1BY31):(0)));var c1U32=(v2n(((str_ne((c1R32),("")))?("0"):(1))));var c1BX32=(((((((c1BX3)*(v2n(c1BW32))))/(80)))+(c1BX2)));var c1BY32=(((v2n(c1BW32))/(c1BX32)));arr1xBZ4BZ40[28][0]=(((var_eq((c1BW32),(c1D9)))?(c1BY32):(0)));var c1U33=(v2n(((str_ne((c1R33),("")))?("0"):(1))));var c1BX33=(((((((c1BX3)*(v2n(c1BW33))))/(80)))+(c1BX2)));var c1BY33=(((v2n(c1BW33))/(c1BX33)));arr1xBZ4BZ40[29][0]=(((var_eq((c1BW33),(c1D9)))?(c1BY33):(0)));var c1U34=(v2n(((str_ne((c1R34),("")))?("0"):(1))));var c1BX34=(((((((c1BX3)*(v2n(c1BW34))))/(80)))+(c1BX2)));var c1BY34=(((v2n(c1BW34))/(c1BX34)));arr1xBZ4BZ40[30][0]=(((var_eq((c1BW34),(c1D9)))?(c1BY34):(0)));var c1U35=(v2n(((str_ne((c1R35),("")))?("0"):(1))));var c1BX35=(((((((c1BX3)*(v2n(c1BW35))))/(80)))+(c1BX2)));var c1BY35=(((v2n(c1BW35))/(c1BX35)));arr1xBZ4BZ40[31][0]=(((var_eq((c1BW35),(c1D9)))?(c1BY35):(0)));var c1U36=(v2n(((str_ne((c1R36),("")))?("0"):(1))));var c1BX36=(((((((c1BX3)*(v2n(c1BW36))))/(80)))+(c1BX2)));var c1BY36=(((v2n(c1BW36))/(c1BX36)));arr1xBZ4BZ40[32][0]=(((var_eq((c1BW36),(c1D9)))?(c1BY36):(0)));var c1BX37=(((((((c1BX3)*(v2n(c1BW37))))/(80)))+(c1BX2)));var c1BY37=(((v2n(c1BW37))/(c1BX37)));arr1xBZ4BZ40[33][0]=(((var_eq((c1BW37),(c1D9)))?(c1BY37):(0)));var c1BX38=(((((((c1BX3)*(v2n(c1BW38))))/(80)))+(c1BX2)));var c1BY38=(((v2n(c1BW38))/(c1BX38)));arr1xBZ4BZ40[34][0]=(((var_eq((c1BW38),(c1D9)))?(c1BY38):(0)));var c1BX39=(((((((c1BX3)*(v2n(c1BW39))))/(80)))+(c1BX2)));var c1BY39=(((v2n(c1BW39))/(c1BX39)));arr1xBZ4BZ40[35][0]=(((var_eq((c1BW39),(c1D9)))?(c1BY39):(0)));var c1BZ41=(sumgeneral(36,0,0,eecm6));var c1AJ50=(sumgeneral(14,0,0,eecm3));var c1AL50=(sumgeneral(14,0,0,eecm2));var c1AJ51=(((c1AJ50)*(c1AJ3)));var c1AL51=(((c1AL50)*(c1AL3)));var c1AN51=(sumgeneral(14,0,0,eecm1));var c1AS3=(((str_ne((c1X3),("transfert court")))?(((((((((((c1D7)+(c1D8)))-(((c1D5)+(c1D6)))))*(24)))-(0.1)))/(0.5))):(((c1BZ41)/(0.5)))));var c1CD12=(sumgeneral(9,0,0,eecm13));var c1L16=(((c1AN51)*(c1L15)));var c1M16=(((c1AN51)*(c1M15)));var c1N16=(((c1AN51)*(c1N15)));var c1O16=(((c1AN51)*(c1O15)));var c1U16=(v2n(((str_ne((c1R16),("")))?("0"):(1))));var c1U17=(v2n(((str_ne((c1R17),("")))?("0"):(1))));var c1O18=(((((((((c1D7)+(c1D8)))-(((c1D5)+(c1D6)))))*(14)))+(((((c1O22)/(c1O21)))/(150)))));var c1R18=(((((c1N18)<=(0)))?(" - Date/heures !"):("")));var c1R19=(((((c1Y9)==(2)))?(((((arr1xBB13BB16[0][0])==(1)))?(((((((c1N18)+(c1N16)))>(18)))?(" - Passer en s�jour !"):(""))):(""))):("")));var c1R20=(((((c1Y9)==(3)))?(((((((c1N18)+(c1N16)))<=(18)))?(" - Passer en dispo !"):(""))):("")));var c1BB20=(((((c1BB7)-(((c1BB17)-(1)))))+(c1BF16)));var c1BN20=(sumgeneral(16,0,0,eecm9));var c1R22=(((((c1BB17)>(1)))?(" - Pr�voir chambre hotel !"):("")));var c1R23=(((str_eq((c1X12),("")))?(" - Ville chargement !"):("")));var c1L24=(((c1L11)*(c1L16)));var c1M24=(((c1M11)*(c1M16)));var c1N24=(((c1N11)*(c1N16)));var c1O24=(((c1O11)*(c1O16)));var c1R24=(((str_eq((c1X13),("")))?(((str_eq((c1X14),("")))?(((str_eq((c1X15),("")))?(((str_eq((c1X16),("")))?(((str_eq((c1X17),("")))?(" - Destination/�tape !"):(""))):(""))):(""))):(""))):("")));var c1AW25=(c1AI4);var c1AY25=(c1AK4);var c1U26=(v2n(((str_ne((c1R26),("")))?("0"):(1))));var c1L28=(c1BF16);var c1N28=(c1BF16);var c1O28=(c1BF16);var c1R30=(((((c1BB20)==(1)))?(((((c1Y9)==(3)))?(((((((v2n(c1D9))/(c1O21)))>=(750)))?(" - trop de conduite, 2 conducteurs imp�ratif !"):(""))):(""))):("")));var c1R31=(((((c1Y9)==(4)))?(((((c1L22)>(150)))?(" - Passer un transfert long"):(""))):("")));var c1L32=(((c1AJ51)+(c1AL51)));var c1N32=(((c1AJ51)+(c1AL51)));var c1L34=(c1BS31);var c1N34=(c1BS31);var c1L37=(c1BJ8);var c1M37=(c1BJ8);var c1N37=(c1BJ8);var c1O37=(c1BJ8);var c1R37=(((((c1Y9)==(3)))?(" - Repas et chambre conducteur(s) � votre charge"):("")));var c1L39=(c1BR17);var c1M39=(c1BR17);var c1N39=(c1BR17);var c1O39=(c1BR17);var c1L40=(c1BU9);var c1M40=(c1BU9);var c1N40=(c1BU9);var c1O40=(c1BU9);var c1L44=(((((c1Y9)==(4)))?(1):(0)));var c1M44=(((((c1Y9)==(1)))?(1):(0)));var c1N44=(((((c1Y9)==(2)))?(1):(0)));var c1O44=(((((c1Y9)==(3)))?(1):(0)));var c1AS4=(((roundup((c1AS3),(0)))/(2)));arr1xAT8AT47[0][0]=(((((c1AR8)>=(c1AS4)))?(c1AS8):(0)));arr1xAT8AT47[1][0]=(((((c1AR9)==(c1AS4)))?(c1AS9):(0)));arr1xAT8AT47[2][0]=(((((c1AR10)==(c1AS4)))?(c1AS10):(0)));arr1xAT8AT47[3][0]=(((((c1AR11)==(c1AS4)))?(c1AS11):(0)));arr1xAT8AT47[4][0]=(((((c1AR12)==(c1AS4)))?(c1AS12):(0)));arr1xAT8AT47[5][0]=(((((c1AR13)==(c1AS4)))?(c1AS13):(0)));var c1CD13=(((((c1CD12)==(0)))?(1):(c1CD12)));arr1xAT8AT47[6][0]=(((((c1AR14)==(c1AS4)))?(c1AS14):(0)));arr1xAT8AT47[7][0]=(((((c1AR15)==(c1AS4)))?(c1AS15):(0)));arr1xAT8AT47[8][0]=(((((c1AR16)==(c1AS4)))?(c1AS16):(0)));arr1xAT8AT47[9][0]=(((((c1AR17)==(c1AS4)))?(c1AS17):(0)));var c1U18=(v2n(((str_ne((c1R18),("")))?("0"):(1))));arr1xAT8AT47[10][0]=(((((c1AR18)==(c1AS4)))?(c1AS18):(0)));var c1O19=(roundup((c1O18),(0)));var c1U19=(v2n(((str_ne((c1R19),("")))?("0"):(1))));arr1xAT8AT47[11][0]=(((((c1AR19)==(c1AS4)))?(c1AS19):(0)));var c1U20=(v2n(((str_ne((c1R20),("")))?("0"):(1))));arr1xAT8AT47[12][0]=(((((c1AR20)==(c1AS4)))?(c1AS20):(0)));arr1xAT8AT47[13][0]=(((((c1AR21)==(c1AS4)))?(c1AS21):(0)));arr1xAT8AT47[14][0]=(((((c1AR22)==(c1AS4)))?(c1AS22):(0)));var c1U23=(v2n(((str_ne((c1R23),("")))?("0"):(1))));arr1xAT8AT47[15][0]=(((((c1AR23)==(c1AS4)))?(c1AS23):(0)));var c1U24=(v2n(((str_ne((c1R24),("")))?("0"):(1))));arr1xAT8AT47[16][0]=(((((c1AR24)==(c1AS4)))?(c1AS24):(0)));arr1xAT8AT47[17][0]=(((((c1AR25)==(c1AS4)))?(c1AS25):(0)));var c1O26=(((((((c1O19)>(c1O10)))?(((c1O19)*(c1O9))):(((c1O10)*(c1O9)))))*(c1BB7)));arr1xAT8AT47[18][0]=(((((c1AR26)==(c1AS4)))?(c1AS26):(0)));arr1xBA26BA27[0][0]=(((str_ne((c1X3),("s�jour")))?(((((c1AS4)<=(5)))?(((((c1AW25)<(c1AY26)))?(c1AZ26):(0))):(0))):(0)));arr1xAT8AT47[19][0]=(((((c1AR27)==(c1AS4)))?(c1AS27):(0)));arr1xBA26BA27[1][0]=(((str_ne((c1X3),("s�jour")))?(((((c1AS4)<=(5)))?(((((c1AY25)>(c1AW26)))?(c1AZ27):(0))):(0))):(0)));arr1xAT8AT47[20][0]=(((((c1AR28)==(c1AS4)))?(c1AS28):(0)));arr1xAT8AT47[21][0]=(((((c1AR29)==(c1AS4)))?(c1AS29):(0)));var c1U30=(v2n(((str_ne((c1R30),("")))?("0"):(1))));arr1xAT8AT47[22][0]=(((((c1AR30)==(c1AS4)))?(c1AS30):(0)));var c1U31=(v2n(((str_ne((c1R31),("")))?("0"):(1))));arr1xAT8AT47[23][0]=(((((c1AR31)==(c1AS4)))?(c1AS31):(0)));var c1BA31=(((((c1AW25)>(18)))?(1):(0)));arr1xAT8AT47[24][0]=(((((c1AR32)==(c1AS4)))?(c1AS32):(0)));var c1BA32=(((((c1AY25)>(22)))?(1):(0)));arr1xAT8AT47[25][0]=(((((c1AR33)==(c1AS4)))?(c1AS33):(0)));var c1BA33=(((((c1AY25)<(6)))?(1):(0)));arr1xAT8AT47[26][0]=(((((c1AR34)==(c1AS4)))?(c1AS34):(0)));arr1xAT8AT47[27][0]=(((((c1AR35)==(c1AS4)))?(c1AS35):(0)));arr1xAT8AT47[28][0]=(((((c1AR36)==(c1AS4)))?(c1AS36):(0)));arr1xAT8AT47[29][0]=(((((c1AR37)==(c1AS4)))?(c1AS37):(0)));var c1L38=(c1BN20);var c1M38=(c1BN20);var c1N38=(c1BN20);var c1O38=(c1BN20);arr1xAT8AT47[30][0]=(((((c1AR38)==(c1AS4)))?(c1AS38):(0)));arr1xAT8AT47[31][0]=(((((c1AR39)==(c1AS4)))?(c1AS39):(0)));arr1xAT8AT47[32][0]=(((((c1AR40)==(c1AS4)))?(c1AS40):(0)));arr1xAT8AT47[33][0]=(((((c1AR41)==(c1AS4)))?(c1AS41):(0)));arr1xAT8AT47[34][0]=(((((c1AR42)==(c1AS4)))?(c1AS42):(0)));arr1xAT8AT47[35][0]=(((((c1AR43)==(c1AS4)))?(c1AS43):(0)));arr1xAT8AT47[36][0]=(((((c1AR44)==(c1AS4)))?(c1AS44):(0)));arr1xAT8AT47[37][0]=(((((c1AR45)==(c1AS4)))?(c1AS45):(0)));arr1xAT8AT47[38][0]=(((((c1AR46)==(c1AS4)))?(c1AS46):(0)));var c1AT48=(sumgeneral(39,0,0,eecm4));var c1L19=(c1AS4);var c1N19=(c1AS4);var c1L20=(c1AT48);var c1N20=(c1AT48);var c1R21=(((((((c1N20)+(c1N16)))>(13.5)))?(((((c1Y9)!=(3)))?(((((c1BB7)<(2)))?(((((c1BB17)<(2)))?(" - 2 conducteurs imp�ratif !"):(""))):(""))):(""))):("")));var c1D23=((c1R17)+(c1R18)+(c1R19)+(c1R20)+(c1R21)+(c1R22)+(c1R23)+(c1R24)+(c1R25)+(c1R26)+(c1R27)+(c1R28)+(c1R29)+(c1R30)+(c1R31)+(c1R32)+(c1R33)+(c1R34)+(c1R35)+(c1R36)+(c1R37));var c1L25=(((c1L20)*(c1L8)));var c1N25=(((c1N20)*(c1N8)));var c1L26=(((((((c1L19)>(c1L10)))?(((c1L19)*(c1L9))):(((c1L10)*(c1L9)))))*(c1BB7)));var c1N26=(((((((c1N19)>(c1N10)))?(((c1N19)*(c1N9))):(((c1N10)*(c1N9)))))*(c1BB7)));var c1BA28=(sumgeneral(2,0,0,eecm8));var c1BA29=(((((c1BA28)>(1)))?(c1BB29):(0)));var c1BA34=(((((c1AS4)<(8.5)))?(1):(0)));var c1BA35=(((((((c1BA31)+(c1BA32)))+(c1BA33)))*(c1BA34)));var c1BA36=(((((c1BA35)>(0)))?(c1BB36):(0)));var c1L41=(c1CD13);var c1M41=(c1CD13);var c1N41=(c1CD13);var c1O41=(c1CD13);var c1L42=(((((((((c1L37)*(c1L38)))*(c1L39)))*(c1L40)))*(c1L41)));var c1M42=(((((((((c1M37)*(c1M38)))*(c1M39)))*(c1M40)))*(c1M41)));var c1N42=(((((((((c1N37)*(c1N38)))*(c1N39)))*(c1N40)))*(c1N41)));var c1O42=(((((((((c1O37)*(c1O38)))*(c1O39)))*(c1O40)))*(c1O41)));arr1xL46O46[0][1]=(((((((c1M30)+(c1M24)))*(c1M42)))*(c1M44)));arr1xL46O46[0][3]=(((((((((((((((((((((c1O24)+(c1O25)))+(c1O26)))+(c1O28)))+(c1O30)))+(c1O32)))+(c1O34)))+(35)))+(c1O36)))*(c1O42)))*(c1O44)));var c1U21=(v2n(((str_ne((c1R21),("")))?("0"):(1))));var c1L35=(c1BA36);var c1N35=(c1BA36);var c1L36=(c1BA29);var c1N36=(c1BA29);var c1U38=(((((((((((((((((((((((((((((((((((((((((((c1U16)*(c1U17)))*(c1U18)))*(c1U19)))*(c1U20)))*(c1U21)))*(c1U22)))*(c1U23)))*(c1U24)))*(c1U25)))*(c1U26)))*(c1U27)))*(c1U28)))*(c1U29)))*(c1U30)))*(c1U31)))*(c1U32)))*(c1U33)))*(c1U34)))*(c1U35)))*(c1U36)))*(c1U37)));arr1xL46O46[0][0]=(((((((((((((((((((((c1L24)+(c1L25)))+(c1L26)))+(c1L28)))+(c1L30)))+(c1L32)))+(c1L34)))+(c1L35)))+(c1L36)))*(c1L42)))*(c1L44)));arr1xL46O46[0][2]=(((((((((((((((((((((c1N24)+(c1N25)))+(c1N26)))+(c1N28)))+(c1N30)))+(c1N32)))+(c1N34)))+(c1N35)))+(c1N36)))*(c1N42)))*(c1N44)));var c1P46=(sumgeneral(4,0,0,eecm5));var c1U39=(((c1P46)*(c1U38)));var c1D22=(((((c1U39)==(0)))?("Vérifiez les données"):(c1U39)));data.TarifTTC=c1D22;data.p1D23=c1D23;};
	

//calcul un devis
function startDevis()
{
	recalc_onclick('');
}


//renvoi le prix du devis
function getPrixDevis()
{
	return eeisnumber(co.TarifTTC)?eedisplayFloatNDTh(co.TarifTTC,0):co.TarifTTC;
}
 

function printPrixDevis()
{
	overlib('prix conseillé par Waydev : <span class="important-color">'+ getPrixDevis() +' &euro</span>', parent.CAPTION, '<strong>Prix conseillé</strong>',parent.CAPTIONPADDING,'4',parent.FGCOLOR, '#FDFDFD',parent.WIDTH, '350',parent.STICKY,parent.CGBACKGROUND,'images/shade_caption.gif',parent.CLOSECLICK,parent.CLOSECOLOR,'#132884', parent.TEXTSIZE,'10px',OFFSETX, -150);
}



//fct d'excel everywhere (modifi�e)

function recalc_onclick(ctl)
{


co.TypePrestation=document.reservation.prestation.value;
co.ZoneChargement=document.reservation.zone.value;
co.VilleChargementPrecise=document.reservation.villedepart.value;
co.DateDepart=eeparsedate_keep_all(document.reservation.datedepart.value);
co.HeureDepart=eeparsedate_keep_time(document.reservation.heuredepart.value);
co.DateDepose=eeparsedate_keep_all(document.reservation.datearrive.value);
co.HeureDepose=eeparsedate_keep_time(document.reservation.heurearrive.value);
co.Kilometrage=eeparseFloatV(document.reservation.kilometragealler.value);
co.VilleDestination=document.reservation.villearrive.value;


co.Etape1="";
co.Etape2="";
co.Etape3="";
co.Etape4="";


//co.NombreConducteur=document.reservation.doublage.value;
co.NombreConducteur="1 conducteur ";
co.CoupureConducteur=document.reservation.coupure.value;
co.RelaisAller=document.reservation.relaisA.value;
co.RelaisRetour=document.reservation.relaisR.value;


var typeCar=getCheckedRadioValue(document.forms["reservation"].elements["typecar"]);

if(typeCar == "Excursion")
{
	typeCar = "standart";
}
else if(typeCar == "GT")
{
	typeCar = "grand tourisme";
}
co.TypeCar=typeCar;




//co.Capacite=document.forms["reservation"].elements["capacite"].value;
co.Capacite="63 places";
co.CodeRemise="";

//alert(co.toSource());

calc(co);

document.reservation.TarifTTC.value=eeisnumber(co.TarifTTC)?eedisplayFloatNDTh(co.TarifTTC,0):co.TarifTTC;
//document.reservation.p1D23.value=co.p1D23;


};

function str_eq(x,y){return(x.toLowerCase()==y.toLowerCase())};function str_ne(x,y){return(x.toLowerCase()!=y.toLowerCase())};function str_gr(x,y){return(x.toLowerCase()>y.toLowerCase())};function str_le(x,y){return(x.toLowerCase()<=y.toLowerCase())};function var_eq(x,y){var xt=mytypeof(x);var yt=mytypeof(y);if(xt!=yt)return false;switch(xt){case 1:case 3:return(x==y);case 2:return str_eq(x,y);default:return false;}};function var_gr(x,y){var xt=mytypeof(x);var yt=mytypeof(y);if(xt!=yt)return(xt>yt);switch(xt){case 1:case 3:return(x>y);case 2:return str_gr(x,y);default:return true;}};function var_le(x,y){var xt=mytypeof(x);var yt=mytypeof(y);if(xt!=yt)return(xt<=yt);switch(xt){case 1:case 3:return(x<=y);case 2:return str_le(x,y);default:return false;}};function mytypeof(v){switch(typeof v){case "number":if(myIsNaN(v))return 4;return 1;case "string":return 2;case "boolean":return 3;case "object":if(v.constructor==Number){if(myIsNaN(v))return 4;return 1;};if(v.constructor==String){return 2;};if(v.constructor==Boolean){return 3;};return 4;default:return 4;}};function myIsNaN(x){return(isNaN(x)||(typeof x=='number'&&!isFinite(x)));};function mod(n,d){return n-d*Math.floor(n/d);};function round(n,nd){if(isFinite(n)&&isFinite(nd)){var sign_n=(n<0)?-1:1;var abs_n=Math.abs(n);var factor=Math.pow(10,nd);return sign_n*Math.round(abs_n*factor)/factor;}else{return NaN;}};function roundup(n,nd){if(isFinite(n)&&isFinite(nd)){var sign_n=(n<0)?-1:1;var abs_n=Math.abs(n);var factor=Math.pow(10,nd);return sign_n*Math.ceil(abs_n*factor)/factor;}else{return NaN;}};function sum2(arr,rt,rb){var sum=0;for(var ii=rt;ii<=rb;ii++){sum+=arr[ii]};return sum};function sum3(arr,rt,ct,rb,cb){var sum=0;for(var ii=rt;ii<=rb;ii++){for(var jj=ct;jj<=cb;jj++){sum+=arr[ii][jj]}};return sum};function sumgeneral(cnt,vsum,vcnt,x){var sum=vsum;for(var ii=0;ii<x.length;ii++){sum+=sum3(x[ii][0],x[ii][1],x[ii][2],x[ii][3],x[ii][4]);};return sum;};function s2n(str){str=String(str).replace(eedecreg,".");return parseFloat(str);}function v2n(v){switch(typeof v){case "number":return v;case "string":return s2n(v);case "boolean":return v?1:0;case "object":if(v.constructor==Number){return v;};if(v.constructor==String){return s2n(v);};if(v.constructor==Boolean){return v?1:0;};return Number.NaN;default:return Number.NaN;}};function eedisplayFloatNDTh(x,nd){if(myIsNaN(x)){return Number.NaN;}else{var res=round(x,nd);if(nd>0){var str=String(res);if(str.indexOf('e')!=-1)return str;if(str.indexOf('E')!=-1)return str;var parts=str.split('.');var res2=eeinsertThousand(parts[0].toString());if(parts.length<2){var decimals=('00000000000000').substring(0,nd);return(res2+eedec+decimals);}else{var decimals=((parts[1]).toString()+'00000000000000').substring(0,nd);return(res2+eedec+decimals);}}else{return(eeinsertThousand(res.toString()));}}};var eeparseFloatVreg=new RegExp("^ *-?[0-9.]+ *$");function eeparseFloatV(str){if(str=="")return str;str=String(str).replace(eedecreg,".");if(!eeparseFloatVreg.test(str)){return str;};var res=parseFloat(str);if(isNaN(res)){return str;}else{return res;}};function eeinsertThousand(whole){if(whole==""||whole.indexOf("e")>=0){return whole;}else{var minus_sign="";if(whole.charAt(0)=="-"){minus_sign="-";whole=whole.substring(1);};var res="";var str_length=whole.length-1;for(var ii=0;ii<=str_length;ii++){if(ii>0&&ii%3==0){res=eeth+res;};res=whole.charAt(str_length-ii)+res;};return minus_sign+res;}};function eedatefmt(fmt,x){if(!isFinite(x))return Number.NaN;var tmp=0;var res="";var len=fmt.length;for(var ii=0;ii<len;ii++){if(fmt[ii]>31){res+=fmtstrings[fmt[ii]-32];}else{switch(fmt[ii]){case 2:res+=eemonth(x);break;case 3:tmp=eemonth(x);if(tmp<10){res+="0";};res+=tmp;break;case 4:res+=fmtmonthnamesshort[eemonth(x)-1];break;case 5:res+=fmtmonthnameslong[eemonth(x)-1];break;case 6:res+=eeday(x);break;case 7:tmp=eeday(x);if(tmp<10){res+="0";};res+=tmp;break;case 8:res+=fmtdaynamesshort[weekday(x,1)-1];break;case 9:res+=fmtdaynameslong[weekday(x,1)-1];break;case 10:tmp=year(x)%100;if(tmp<10){res+="0";};res+=tmp;break;case 11:res+=year(x);break;case 12:res+=hour(x);break;case 13:tmp=hour(x);if(tmp<10){res+="0";};res+=tmp;break;case 14:res+=hour(x)%12;break;case 15:tmp=hour(x)%12;if(tmp<10){res+="0";};res+=tmp;break;case 16:res+=minute(x);break;case 17:tmp=minute(x);if(tmp<10){res+="0";};res+=tmp;break;case 18:res+=second(x);break;case 19:tmp=second(x);if(tmp<10){res+="0";};res+=tmp;break;case 21:case 22:res+="AM/PM";break;};};};return res;};function eeisnumber(v){if(isNaN(v)||v==Number.NEGATIVE_INFINITY||v==Number.POSITIVE_INFINITY){return false;}else{switch(typeof v){case "number":return true;case "object":return v.constructor==Number;default:return false;}}};function leap_gregorian(year){return((year%4)==0)&&(!(((year%100)==0)&&((year%400)!=0)));}var GREGORIAN_EPOCH=1721425;function gregorian_to_jd(year,month,day){return(GREGORIAN_EPOCH-0)+(365*(year-1))+Math.floor((year-1)/4)+(-Math.floor((year-1)/100))+Math.floor((year-1)/400)+Math.floor((((367*month)-362)/12)+((month<=2)?0:(leap_gregorian(year)?-1:-2))+day);}function jd_to_gregorian(jd){var wjd,depoch,quadricent,dqc,cent,dcent,quad,dquad,yindex,year,yearday,leapadj;wjd=Math.floor(jd);depoch=wjd-GREGORIAN_EPOCH-1;quadricent=Math.floor(depoch/146097);dqc=mod(depoch,146097);cent=Math.floor(dqc/36524);dcent=mod(dqc,36524);quad=Math.floor(dcent/1461);dquad=mod(dcent,1461);yindex=Math.floor(dquad/365);year=(quadricent*400)+(cent*100)+(quad*4)+yindex;if(!((cent==4)||(yindex==4))){year++;}yearday=wjd-gregorian_to_jd(year,1,1);leapadj=((wjd<gregorian_to_jd(year,3,1))?0:(leap_gregorian(year)?1:2));var month=Math.floor((((yearday+leapadj)*12)+373)/367);var day=(wjd-gregorian_to_jd(year,month,1))+1;return new Array(year,month,day);}var r99=new RegExp("[a-zA-Z]+|[0-9]+|:","g");function eeparsedate_keep_all(str){var res=eeparsedate(str,3);if(isNaN(res)){return 1;}else{return res;}};function eeparsedate_keep_allV(str){if(str=="")return str;var res=eeparsedate(str,3);if(isNaN(res)){return str;}else{return res;}};function eeparsedate_keep_time(str){var res=eeparsedate(str,2);if(isNaN(res)){return 0;}else{return res;}};function eeparsedate_keep_timeV(str){if(str=="")return str;var res=eeparsedate(str,2);if(isNaN(res)){return str;}else{return res;}};function eeparsedate(str,keep){var year=1900;var month=1;var day=1;var hour=0;var minutes=0;var seconds=0;var ptr=0;var current=0;var lookahead;var parts;parts=str.match(r99);var len=0;if(str.length>0)len=parts.length;var time_parsed=false;if(len<1){return Number.NaN;}else{var cmd=1;if(len>1){lookahead=parts[1];if(lookahead==":"){cmd=2};};while(cmd>0&&ptr<len){if(cmd==1){current=parseFloat(parts[ptr]);if(isNaN(current))return Number.NaN;lookahead=parts[ptr+1];if(lookahead==":"){cmd=2;}else{if(current>1899){year=current;ptr++;current=parseFloat(parts[ptr++]);if(isNaN(current))return Number.NaN;month=current;current=parseFloat(parts[ptr++]);if(isNaN(current))return Number.NaN;day=current;cmd=3;}else if(current<32){if(eeisus){month=current;ptr++;current=parseFloat(parts[ptr++]);if(isNaN(current))return Number.NaN;if(current>1899){year=current;}else{day=current;current=parseFloat(parts[ptr++]);if(isNaN(current))return Number.NaN;year=current;if(year<30){year+=2000}};}else{day=current;ptr++;current=parseFloat(parts[ptr++]);if(isNaN(current))return Number.NaN;if(current>1899){year=current;month=day;day=1;}else{month=current;current=parseFloat(parts[ptr++]);if(isNaN(current))return Number.NaN;year=current;if(year<30){year+=2000}};}cmd=3;}else{return Number.NaN;};};}else if(cmd==2||cmd==3){if(cmd==3&&time_parsed){return Number.NaN;};time_parsed=true;current=parseFloat(parts[ptr++]);if(isNaN(current))return Number.NaN;hour=current;lookahead=parts[ptr++];if(lookahead==":"){current=parseFloat(parts[ptr++]);if(isNaN(current))return Number.NaN;minutes=current;current=parts[ptr];if(current==":"){ptr++;current=parseFloat(parts[ptr++]);if(isNaN(current))return Number.NaN;seconds=current;};};cmd=1;}}};switch(keep){case 1:return date(year,month,day);case 2:return time(hour,minutes,seconds);case 3:return date(year,month,day)+time(hour,minutes,seconds);default:return Number.NaN;}};function date(year,month,day){if(!isFinite(day)||!isFinite(month)||!isFinite(year))return Number.NaN;if(year<1900){year+=1900};if(year>9999)return Number.NaN;var adj_year=year;var adj_month=month;if(month>0){adj_year=year+Math.floor((month-1)/12);adj_month=((month-1)%12)+1;}else if(month<0){var tmp=Math.ceil((-month)/12);adj_year=year-tmp;adj_month=adj_month+tmp*12;}var res=Math.floor(gregorian_to_jd(adj_year,adj_month,day)-2415020);if(res>59)return res+1;return res;};function eeday(serial_number){if(!isFinite(serial_number))return Number.NaN;if(serial_number<1){return 0;}if(serial_number>60)serial_number--;var res=jd_to_gregorian(serial_number+2415020);return res[2];};function hour(serial_number){if(!isFinite(serial_number))return Number.NaN;var res=Math.floor((serial_number-Math.floor(serial_number))*86400+0.5);return Math.floor(res/3600);}function minute(serial_number){if(!isFinite(serial_number))return Number.NaN;var res=Math.floor((serial_number-Math.floor(serial_number))*86400+0.5);return Math.floor(res/60)%60;};function eemonth(serial_number){if(!isFinite(serial_number))return Number.NaN;if(serial_number<1){return 1;}if(serial_number>60)serial_number--;var res=jd_to_gregorian(serial_number+2415020);return res[1];};function second(serial_number){if(!isFinite(serial_number))return Number.NaN;var res=Math.floor((serial_number-Math.floor(serial_number))*86400+0.5);return res%60;};function time(hour,minute,second){if(!isFinite(second)||!isFinite(minute)||!isFinite(hour))return Number.NaN;return((second+minute*60+hour*3600)%86400)/86400;};function weekday(serial_number,return_type){if(!isFinite(return_type)||!isFinite(serial_number))return Number.NaN;if(return_type<1||return_type>3)return Number.NaN;var res=(serial_number+6)%7;switch(Math.floor(return_type)){case 1:return res+1;case 2:return(res+6)%7+1;case 3:return(res+6)%7;};return "hej";};function year(serial_number){if(!isFinite(serial_number))return Number.NaN;if(serial_number<1){return 1900;}if(serial_number>60)serial_number--;var res=jd_to_gregorian(serial_number+2415020);return res[0];};


